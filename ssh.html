<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="assets/portal.ico">
  <title>SSH -- Homelab | Hylown</title>
  <link rel="stylesheet" href="assets/css/hylowncom.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
</head>
<body>

  <header class="header top-bar">
    <div class="wrapper no-pad">
      <ul class="navigation">
        <li class="hamburger-icon"><a href="javascript:void(0)" onclick="toggleNav()"><span>&nbsp;</span><span>&nbsp;</span><span>&nbsp;</span></a></li>
        <li style="padding:0;"><a style="padding:0;margin:0 10;" href="https://hylown.com"><img src="assets/portal.png" width="31px" height="31px"></a></li>
        <li><a href="homelab.html">Homelab</a></li>
        <li><a href="apps.html">Apps</a></li>
        <li><a href="consulting.html">Consulting</a></li>
        <li><a style="font-size:1.5em;" href=""><i class="bi bi-linkedin"></i></a></li>
        <li><a style="font-size:1.5em;" href="https://github.com/BStew00/hylowncom_site"><i class="bi bi-github"></i></a></li>
        <li><a href="buy_us_a_coffee.html">Support Us</a></li>
      </ul>
    </div>
  </header>

  <div class="container">
    <main class="main">
        <div class="main__inner grid">
            <div class="sidebar sidebar--primary" id="sidebar--primary">
                <div class="sidebar__scrollwrap">
                    <div class="sidebar__inner sidebar__inner-left">
                      <div>
                        <label>Homelab</label>
                        <a href="javascript:void(0)" class="closebtn" id="closebtn" onclick="toggleNav()" style="display:none;">&times;</a>
                      </div>
                      <ul class="side-nav">
                        <li><a id="Home" href="homelab.html">Home</a></li>
                        <li><a id="SSH" href="ssh.html">SSH</a></li>
                        <li><a id="RaspberryPi" href="raspberry_pi.html">Raspberry Pi</a>
                          <ul class="side-nav side-nav-2">
                            <li><a id="RaspberryPi-Initialize" href="raspberry_pi_initialize.html">Initialize</a></li>
                            <li><a id="RaspberryPi-PCIE" href="raspberry_pi_pcie.html">PCIe Boot NVMe</a></li>
                            <li><a id="Extras" href="raspberry_pi_extras.html">Extras</a></li>
                          </ul>
                        </li>
                        <li><a id="LocalHTTPServer" href="local_http_server.html">Local HTTP Server</a></li>
                        <li><a id="LocalGitServer" href="local_git_server.html">Local Git Server</a></li>
                        <li><a id="RemoteGitServer" href="remote_git_server.html">Remote Git Server</a></li>
                      </ul>
                    </div>
                </div>
            </div>
            <div class="sidebar sidebar--secondary" style="top:48px;">
                <div class="sidebar__scrollwrap">
                    <div class="sidebar__inner">
                      <div>
                        <label>On this page</label>
                      </div>
                      <ul class="side-nav template__nav" id="right-nav">
                        <li><a href="">back to top</a></li>
                        <li class="template__nav-item"><a href="#ssh-uris">SSH URIs</a></li>
<li class="template__nav-item"><a href="#ssh-keypairs">SSH Keypairs</a></li>
<li class="template__nav-item"><a href="#authorized-keys">Authorized Keys</a></li>
<li class="template__nav-item"><a href="#known-hosts">Known Hosts</a></li>
<li class="template__nav-item"><a href="#create-a-keypair">Create a Keypair</a></li>
<li class="template__nav-item"><a href="#configure-server-for-a-client">Configure Server for a Client</a></li>
<li class="template__nav-item"><a href="#passwordless-ssh">Passwordless SSH</a></li>
<li class="template__nav-item"><a href="#outro">Outro</a></li>
                      </ul>
                    </div>
                </div>
            </div>
            <div class="content">
              <article>
                <a class="source-button" href="https://github.com/BStew00/hylowncom_site" title="Edit this page"><svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg></a>
                <a class="source-button" href="ssh.md" title="View source of this page"><svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg></a>
                <br>
                <h1 id="ssh"><abbr title="Secure Shell Protocol">SSH</abbr></h1>
<h3 class="subtitle" id="its-actually-quite-easy"><em>It&rsquo;s actually quite easy!</em></h3>
<p><a href="https://en.wikipedia.org/wiki/Secure_Shell"><abbr title="Secure Shell Protocol">SSH</abbr></a> is a very common encrypted and authenticated transport protocol from a <code>client</code> to a <code>server</code>.</p>
<p>In a homelab, the client might be a Windows or MacOS laptop, or a Raspberry Pi machine.  The server might be a Raspberry Pi machine being used as a home server, or a remote web host server.</p>
<p><img alt="" class="className" height="314.8" id="id" src="../assets/ssh_graph.png" width="420" /></p>
<p><abbr title="Secure Shell Protocol">SSH</abbr> is often already setup on a server.  If it&rsquo;s not it&rsquo;s generally easy to set it up.  </p>
<p>You can see a log of <abbr title="Secure Shell Protocol">SSH</abbr> activity by using the following command on a server</p>
<pre><code title="An Example Code Block">$ journalctl -u ssh
</code></pre>
<p>If you&rsquo;re on Windows, download and install Git, then you can run these commands using the <img alt="" src="assets/Git_Bash.png" style="display:inline;padding:0;" /> Git Bash command line utility that comes with a Git installation on Windows.</p>
<h2 class="template__section" id="ssh-uris"><abbr title="Secure Shell Protocol">SSH</abbr> URIs</h2>
<p>A client connects to a server using an <abbr title="Secure Shell Protocol">SSH</abbr> <a href="https://en.wikipedia.org/wiki/Uniform_Resource_Identifier"><abbr title="Uniform Resource Identifier">URI</abbr></a> such as</p>
<pre><code class="language-bash">ssh://[user@]&lt;server-hostname&gt;&lt;some-path&gt;
</code></pre>
<p>The square brackets <code>[user@]</code> indicate that part is optional.  If the username on the client and the server are the same, this can be omitted. The <code>&lt;server-hostname&gt;</code> is the server&rsquo;s domain name or IP address; it might be, for example, the name of a server in your home <code>myHomelab.local</code>, or it might be an external website like <code>example.com</code>:</p>
<pre><code class="language-bash">ssh://ted@example.com/path/to/project.git
</code></pre>
<p>Here, the <code>&lt;some-path&gt;</code> part takes us from root on the server to a Git project.  </p>
<p>You can also use an <a href="https://en.wikipedia.org/wiki/Secure_copy_protocol"><abbr title="Secure Copy Protocol">SCP</abbr></a>-like syntax:</p>
<pre><code class="language-bash">[user@]&lt;server-hostname&gt;:&lt;some-path&gt;
</code></pre>
<p>Note that <code>&lt;some-path&gt;</code> may or may not start with a <code>/</code> &hellip; you use it if the path is from root of the server, and omit it if the path is relative to the home directory of the user on the server.  For example</p>
<pre><code class="language-bash">ted@example.com:repos/project.git
</code></pre>
<p>and this</p>
<pre><code class="language-bash">ted@example.com:/home/ted/repos/project.git
</code></pre>
<p>go to the same <code>project.git</code> on the server if the directory <code>repos</code> is in ted&rsquo;s home directory <code>/home/ted</code>.</p>
<p>We can connect to a server&rsquo;s terminal using the <code>ssh</code> command with an <abbr title="Secure Shell Protocol">SSH</abbr> <abbr title="Uniform Resource Identifier">URI</abbr> on a client:</p>
<pre><code class="language-bash">$ ssh [user@]&lt;server-hostname&gt;
</code></pre>
<h2 class="template__section" id="ssh-keypairs"><abbr title="Secure Shell Protocol">SSH</abbr> Keypairs</h2>
<p><abbr title="Secure Shell Protocol">SSH</abbr> works by using a keypair.  The filenames of the two keypair files is often <code>id_rsa</code> and <code>id_rsa.pub</code>, but might be <code>id_ed25519</code> and <code>id_ed25519.pub</code>. </p>
<p>The one with <code>.pub</code> is the public key, and it is given to the server.  Teh one without <code>.pub</code> is the private key and should be kept securely on the client&rsquo;s machine.  </p>
<p>These keypair files are typically stored in a directory named <code>.ssh</code> in the user&rsquo;s home directory.  On a Linux machine this is probably <code>~/.ssh</code> which is shorthand for <code>/home/&lt;user&gt;/.ssh</code>.  On a Windows machine it is probably <code>C:\Users\&lt;user&gt;\.ssh</code>.</p>
<p>There might be two other files in this directory: <code>authorized_keys</code> and <code>known_hosts</code>.</p>
<p>So, your <code>.ssh</code> directory with have two text files named</p>
<ul>
<li><code>id_rsa</code> (or <code>id_ed25519</code>)</li>
<li><code>id_rsa.pub</code> (or <code>id_ed25519.pub</code>)</li>
</ul>
<p>and might additionally have the text files </p>
<ul>
<li><code>authorized_keys</code></li>
<li><code>known_hosts</code></li>
</ul>
<h2 class="template__section" id="authorized-keys">Authorized Keys</h2>
<p>This file is in the <code>.ssh</code> directory on a server. It contains the public keys of users on client machines.  Each entry in this file looks something like:</p>
<pre><code class="language-bash">ssh-ed25519 AAAATHISISAVERYLONGSTRINGHELLOTHEQUICKBROWNFOXJUMPEDOVERALOGTWENTYTIMES &lt;user&gt;@&lt;client-hostname&gt;
</code></pre>
<p>Note that this is all on one line; each user&rsquo;s public key must be on one line without breaks.</p>
<h2 class="template__section" id="known-hosts">Known Hosts</h2>
<p>This file is in the <code>.ssh</code> directory on a client. <abbr title="Secure Shell Protocol">SSH</abbr> automatically stores the identity of servers in this file.  There might be another file like this under <code>/etc</code> that serves the same purpose except for all users on 
the machine. </p>
<p>Any given machine can be both a client and a server, and thus might have both files <code>authorized_keys</code> and 
<code>known_hosts</code> in the <code>.ssh</code> directory.  For example, one of my Raspberry Pi machines has both files because I <abbr title="Secure Shell Protocol">SSH</abbr> into it from my Windows laptop, and I also use it to <abbr title="Secure Shell Protocol">SSH</abbr> into the local git server and a remote server.</p>
<h2 class="template__section" id="create-a-keypair">Create a Keypair</h2>
<p>You can check for existing <abbr title="Secure Shell Protocol">SSH</abbr> keys with this command</p>
<pre><code class="language-bash">$ ls ~/.ssh
</code></pre>
<p>If there are no keys, or even an <code>.ssh</code> directory, you can create them by running ssh-keygen:</p>
<pre><code class="language-bash"> $ ssh-keygen
</code></pre>
<p>It will show the following:</p>
<pre><code class="language-console">Generating public/private rsa key pair.
Enter file in which to save the key (/home/ted/.ssh/id_rsa):
Created directory '/home/ted/.ssh'.
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/ted/.ssh/id_rsa.
Your public key has been saved in /home/ted/.ssh/id_rsa.pub.
The key fingerprint is:
a6:82:42:8e:d7:f1:cc:9b:31:53:96:89:49:da:9b:e3 ted@mylaptop.local
</code></pre>
<p>For <code>Enter file in which to save the key...</code> either hit enter to use the default,
or enter one, e.g. <code>/home/&lt;user&gt;/.ssh/id_rsb</code>.  This could be useful if you already have a keypair put want to create another one.  </p>
<p>For <code>Enter passphrase...</code> you can hit enter without typing anything to have no password.</p>
<p>Running <code>ssh-keygen</code> creates the files <code>id_rsa</code>, <code>id_rsa.pub</code>, and the <code>~/.ssh</code> dir if it doesn&rsquo;t exist.</p>
<h2 class="template__section" id="configure-server-for-a-client">Configure Server for a Client</h2>
<p>You allow a client to <abbr title="Secure Shell Protocol">SSH</abbr> into a server by adding the client&rsquo;s public key to the server&rsquo;s <code>authorized_keys</code> file.  </p>
<p>If the user that you wish to allow the client <abbr title="Secure Shell Protocol">SSH</abbr> access doesn&rsquo;t areldy exist, you can create it using:</p>
<pre><code class="language-bash">$ sudo adduser &lt;user&gt;
</code></pre>
<p>If not already logged in as this user, then you can switch to it:</p>
<pre><code class="language-bash">$ su &lt;user&gt;
</code></pre>
<p>After entering the user&rsquo;s password, navigate to that user&rsquo;s home directory and check for a <code>.ssh</code> directory:</p>
<pre><code class="language-bash">$ cd
$ ls -a
</code></pre>
<p>If it doesn&rsquo;t already exist, you can make and configure one with:</p>
<pre><code class="language-bash">$ mkdir .ssh
$ chmod 700 .ssh
</code></pre>
<p>If you just made a new <code>.ssh</code> directory, or if one already existed but did not already contain an <code>authorized_keys</code> file, you can create and configure one like this:</p>
<pre><code class="language-bash">$ touch .ssh/authorized_keys
$ chmod 600 .ssh/authorized_keys
</code></pre>
<p>You will need some way to transfer the client&rsquo;s public key to the server.  We&rsquo;re assuming a homelab setup, so you might be able to do this all on the client machine by simply using the clipboard to copy/paste the public key. For example, if the key on the client is in the file <code>id_rsa.pub</code>, then run</p>
<pre><code class="language-bash">$ cat ~/.ssh/id_rsa.pub
</code></pre>
<p>and use your mouse to select and copy the key; copy everything between and including <code>ssh-rsa</code> to <code>&lt;user&gt;@&lt;hostname&gt;</code>, then you can paste this in the server if you can already access the server from the client using, e.g. a web browser to access the control panel of your web host server.  If you can&rsquo;t use the copy/paste method, then choose any other method.  </p>
<p>On the server, create a temporary file to store the client&rsquo;s public key:</p>
<pre><code class="language-bash">$ touch ~/.ssh/tmp id_rsa[.id].pub
</code></pre>
<p>where <code>[.id]</code> is some string you use to identify this key from others (this is optional).</p>
<p>Then open that file</p>
<pre><code class="language-bash">$ nano ~/.ssh/tmp id_rsa[.id].pub
</code></pre>
<p>and use your mouse to paste the client&rsquo;s public key.  Remember from <a href="#authorized_keys"><code>authorized_keys</code></a>, above, that it all must be on one line.</p>
<p>Then you can place the key at the end of the server&rsquo;s <code>authorized_keys</code> file using:</p>
<pre><code class="language-bash">$ cat ~/.ssh/tmp/id_rsa[.id].pub &gt;&gt; ~/.ssh/authorized_keys
</code></pre>
<p>Now the specified user on the client machine should be able to <abbr title="Secure Shell Protocol">SSH</abbr> into this user on the server.</p>
<h2 class="template__section" id="passwordless-ssh">Passwordless <abbr title="Secure Shell Protocol">SSH</abbr></h2>
<p>If you wish to avoid typing in the password for each <abbr title="Secure Shell Protocol">SSH</abbr>, you can setup password-less <abbr title="Secure Shell Protocol">SSH</abbr>!</p>
<p>On the client run</p>
<pre><code class="language-bash">$ ssh-copy-id [user@]&lt;server-hostname&gt;
</code></pre>
<p>where <code>[user@]</code> and <code>&lt;server-hostname&gt;</code> are that of server.</p>
<p>Enter the server user&rsquo;s password (for the last time &hellip; yay!).</p>
<p>Now you can run</p>
<pre><code class="language-bash">$ ssh [user@]&lt;server-hostname&gt;
</code></pre>
<p>to access the server&rsquo;s terminal without needing to give a password. </p>
<h2 class="template__section" id="outro">Outro</h2>
<p><abbr title="Secure Shell Protocol">SSH</abbr> is seen by many as almost a dark art, something they know can be done, but only by wizards who have some secret knowledge they don&rsquo;t have.  However, as you can see, there really isn&rsquo;t much to know:</p>
<ul>
<li><abbr title="Uniform Resource Identifier">URI</abbr>: above we can see it&rsquo;s not so complicated, is it?</li>
<li>Keypair: Private stays on the client, Public is copied to server&rsquo;s <code>authorized_keys</code> file</li>
</ul>
<p>And that&rsquo;s the gist of it.</p>
                <p class="outro">To suggest an edit or correction to this page, please click the "Edit this page" button below or at the top to access the source file on GitHub.</p>
                <br>
                <div class="source-button-bottom">
                  <div class="source-button-bottom-inner">
                    <a id="a" class="source-button" href="ssh.md" title="View source of this page"><svg xmlns="http://www.w3.org/2000/svg" width="50px" height="50px" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg></a>
                    <label id="b">View</label>
                  </div>
                  <div class="source-button-bottom-inner">
                    <a id="c" class="source-button" href="https://github.com/BStew00/hylowncom_site" title="Edit this page"><svg xmlns="http://www.w3.org/2000/svg" width="50px" height="50px" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg></a>
                    <label id="d">Edit</label>
                  </div>
                </div>
              </article>
            </div>
        </div>
    </main>
    <footer class="footer">
      <!--<div><p>All content copyright Hylown</p></div>-->
      <div><a href="tou.html">Terms of Use</a></div>
      <div><a href="https://hylown.com"><img src="assets/portal.png" width="100px" height="100px"></a></div>
      <div><a href="">back to top</a></div>
    </footer>
  </div>
  <script>
    document.getElementById('SSH').classList.add('active')
  </script>
  <script src="assets/javascript/hylowncom.js"></script>
</body>
</html>