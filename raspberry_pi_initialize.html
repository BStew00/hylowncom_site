<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="assets/portal.ico">
  <title>Raspberry Pi -- Homelab | Hylown</title>
  <link rel="stylesheet" href="assets/css/hylowncom.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
</head>
<body>

  <header class="header top-bar">
    <div class="wrapper no-pad">
      <ul class="navigation">
        <li class="hamburger-icon"><a href="javascript:void(0)" onclick="toggleNav()"><span>&nbsp;</span><span>&nbsp;</span><span>&nbsp;</span></a></li>
        <li style="padding:0;"><a style="padding:0;margin:0 10;" href="https://hylown.com"><img src="assets/portal.png" width="31px" height="31px"></a></li>
        <li><a href="homelab.html">Homelab</a></li>
        <li><a href="apps.html">Apps</a></li>
        <li><a href="consulting.html">Consulting</a></li>
        <li><a style="font-size:1.5em;" href=""><i class="bi bi-linkedin"></i></a></li>
        <li><a style="font-size:1.5em;" href=""><i class="bi bi-github"></i></a></li>
        <li><a href="buy_us_a_coffee.html">Support Us</a></li>
      </ul>
    </div>
  </header>

  <div class="container">
    <main class="main">
        <div class="main__inner grid">
            <div class="sidebar sidebar--primary" id="sidebar--primary">
                <div class="sidebar__scrollwrap">
                    <div class="sidebar__inner sidebar__inner-left">
                      <div>
                        <label>Homelab</label>
                        <a href="javascript:void(0)" class="closebtn" id="closebtn" onclick="toggleNav()" style="display:none;">&times;</a>
                      </div>
                      <ul class="side-nav">
                        <li><a id="Home" href="homelab.html">Home</a></li>
                        <li><a id="SSH" href="ssh.html">SSH</a></li>
                        <li><a id="RaspberryPi" href="raspberry_pi.html">Raspberry Pi</a>
                          <ul class="side-nav side-nav-2">
                            <li><a id="RaspberryPi-Initialize" href="raspberry_pi_initialize.html">Initialize</a></li>
                            <li><a id="RaspberryPi-PCIE" href="raspberry_pi_pcie.html">PCIe Boot NVMe</a></li>
                            <li><a id="Extras" href="raspberry_pi_extras.html">Extras</a></li>
                          </ul>
                        </li>
                        <li><a id="LocalHTTPServer" href="local_http_server.html">Local HTTP Server</a></li>
                        <li><a id="LocalGitServer" href="local_git_server.html">Local Git Server</a></li>
                        <li><a id="RemoteGitServer" href="remote_git_server.html">Remote Git Server</a></li>
                      </ul>
                    </div>
                </div>
            </div>
            <div class="sidebar sidebar--secondary" style="top:48px;">
                <div class="sidebar__scrollwrap">
                    <div class="sidebar__inner">
                      <div>
                        <label>On this page</label>
                      </div>
                      <ul class="side-nav template__nav" id="right-nav">
                        <li><a href="">back to top</a></li>
                        <li class="template__nav-item"><a href="#use-rp-imager">Use RP Imager</a></li>
<li class="template__nav-item"><a href="#optional-save-firstbootsh">Optional: save firstboot.sh</a></li>
<li class="template__nav-item"><a href="#first-boot">First Boot</a></li>
<li class="template__nav-item"><a href="#static-ip">Static IP</a></li>
<li class="template__nav-item"><a href="#ssh">SSH</a></li>
<li class="template__nav-item"><a href="#ssh-without-password">SSH without Password</a></li>
                      </ul>
                    </div>
                </div>
            </div>
            <div class="content">
              <article>
                <a class="source-button" href="" title="Edit this page"><svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg></a>
                <a class="source-button" href="raspberry_pi_initialize.md" title="View source of this page"><svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg></a>
                <br>
                <h1 id="setting-up-a-raspberry-pi">Setting up a Raspberry Pi</h1>
<p><img alt="" height="314.8" src="assets/RPi_Imager.png" width="420" /></p>
<h2 class="template__section" id="use-rp-imager">Use RP Imager</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your micro SD card already has data on it, you can first use the Raspberry Pi Imager
to erase (reformat) the card. With the card inserted into the machine, in Imager, under
<code>Raspberry Pi Device</code> choose <code>No filtering</code>, under <code>Operating System</code> choose
<code>Erase, format card as fat32</code>, and under <code>Storage</code> choose the micro SD card.</p>
</div>
<p>Install the latest version of <a href="https://www.raspberrypi.com/software/">Raspberry Pi Imager</a> on a computer connected to your network.  Connect a micro SD card to that computer, open the Imager and make the following configurations:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Startup page</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>Raspberry Pi Device</code></td>
<td style="text-align: left;">Raspberry Pi 5</td>
</tr>
<tr>
<td style="text-align: left;"><code>Operating System</code></td>
<td style="text-align: left;">Raspberry Pi OS (64-bit)<br>Raspberry Pi OS (other) &gt;&gt; Raspberry Pi OS Lite (64-bit)</td>
</tr>
<tr>
<td style="text-align: left;"><code>Storage</code></td>
<td style="text-align: left;">Select the micro SD card</td>
</tr>
</tbody>
</table>
<p>On the development machine we used the regular OS, on the server we used the Lite version.</p>
<p>Click <code>Next</code></p>
<p>Click <code>Edit Settings</code></p>
<table>
<thead>
<tr>
<th style="text-align: left;">General tab</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>hostname</code></td>
<td style="text-align: left;">defines the hostname of your machine</td>
</tr>
<tr>
<td style="text-align: left;"><code>Username</code></td>
<td style="text-align: left;">defines the username of the admin account</td>
</tr>
<tr>
<td style="text-align: left;"><code>Password</code></td>
<td style="text-align: left;">defines the password of the admin account</td>
</tr>
<tr>
<td style="text-align: left;"><code>SSID</code></td>
<td style="text-align: left;">name of your WLAN</td>
</tr>
<tr>
<td style="text-align: left;"><code>password</code></td>
<td style="text-align: left;">passkey for your WLAN</td>
</tr>
<tr>
<td style="text-align: left;"><code>Wireless LAN country</code></td>
<td style="text-align: left;">US</td>
</tr>
<tr>
<td style="text-align: left;"><code>Time Zone</code></td>
<td style="text-align: left;">pick yours</td>
</tr>
<tr>
<td style="text-align: left;"><code>Keyboard Layout</code></td>
<td style="text-align: left;">us</td>
</tr>
</tbody>
</table>
<p>For the username and password of the admin account, use only lowercase letters; some users have reported bugs.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Services tab</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>Use password authentication</code></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>See the <a href="https://www.raspberrypi.com/documentation/computers/getting-started.html#advanced-options">official docs</a> discussion of the two SSH options.</p>
<p>Click <code>Save</code></p>
<p>Click <code>Yes</code> to apply OS customization settings</p>
<p>Click <code>Yes</code> to overwrite disk</p>
<p>Wait for completion &amp; verification </p>
<p>Image completed when you see <code>Write Successful</code> message.</p>
<div class="admonition note">
<p class="admonition-title">Wired vs. Wireless</p>
<p>We have our Raspberry Pi machines connected directly to our WiFi router using ethernet cables.  Above, we configure the wireless LAN.  This means there will initially therefore be two IP addresses assigned to each Raspberry Pi configured this way, one for the wired connection and one for the wireless connection.  We thus disable WiFi on the Raspberry Pi because we wish to use the wired connection in hopes of having consistently better speeds and to reduce the burden on the hardware (i.e. the WiFi chip).</p>
<p>But why enable wireless LAN in the first place? Because it is now easy to re-enable WiFi if ever desired. </p>
<p>You may choose to use either wired, or wireless, or even both if you really want.</p>
</div>
<h2 class="template__section" id="optional-save-firstbootsh">Optional: save firstboot.sh</h2>
<p>If you wish to boot your Raspberry Pi&rsquo;s OS from a drive connected to the PCIe interface, then do the steps in this section; otherwise, skip to the next section.</p>
<p>After completing the steps above to write an OS image to a micro SD card, remove and then re-insert the card in the same machine &ndash; this will allow you to access the card as a storage device; initially after writing the image to the card your machine will likely see it as a bootable drive and not allow you to access its files.</p>
<p>Copy the file <code>firstboot.sh</code> from the micro SD card to somewhere on this machine.</p>
<p>This file will be used later when we configure the Raspberry Pi to boot from an NVMe SSD connected to the official Raspberry Pi PCIe-to-M.2 HAT+.</p>
<h2 class="template__section" id="first-boot">First Boot</h2>
<p>Remove the micro SD card from the machine used to burn the image.</p>
<p>Make sure the Raspberry Pi machine is shutdown, and remove the power cord.</p>
<p>Insert the micro SD card into the Raspberry Pi machine.</p>
<p>Power up the Raspberry Pi machine.</p>
<p>On another machine connected to the same network, perhaps the one just used to burn the OS image, open a terminal (Linux/MacOS) or a command prompt (Windows) and open an SSH connection to the Raspberry Pi using:</p>
<pre><code class="language-bash">$ ssh [user@]&lt;hostname&gt;
</code></pre>
<p>using the user and hostname you just entered in the Imager, above. This should work since we enabled SSH when creating the OS image.  </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When you first try to SSH into the Raspberry Pi it is possible that the SSH program will not allow you and throw an error message/warning saying something about a possible &ldquo;man-in-the-middle&rdquo; issue.  This might happen if you already had this Raspberry Pi machine setup previously to SSH to the current machine being used (this happened to us when we re-installed the OS on an existing Raspberry Pi machine). Basically, the SSH program is telling you that the SSH key it is seeing on the Raspberry Pi &ndash; the one created when we enabled SSH in the above process of getting the OS to a micro SD card &ndash; is not the same one it sees in its list of existing keys for that machine.</p>
<p>Don&rsquo;t worry, there is an easy fix: on the machine you are using to SSH into the Raspberry Pi, run:</p>
<p><code>bash
$ ssh-keygen -R &lt;hostname&gt;</code></p>
<p>where <code>&lt;hostname&gt;</code> is that of the Raspberry Pi.  This will remove all the duplicate keys for the Raspberry Pi on the current machine, and you should have no more problems trying to SSH.</p>
</div>
<p>Enter the Raspbery Pi user&rsquo;s password, and you should then see the Raspberry Pi&rsquo;s terminal:</p>
<pre><code class="language-bash">user@hostname:~$
</code></pre>
<p>On the Raspberry Pi run the following:</p>
<pre><code class="language-bash">$ sudo apt update &amp;&amp; sudo apt full-upgrade
</code></pre>
<h2 class="template__section" id="static-ip">Static IP</h2>
<p>Through an SSH connection to the Raspberry Pi, run this to find it&rsquo;s IP address:</p>
<pre><code class="language-bash">$ hostname -I
</code></pre>
<p>You might see two IP addresses!!</p>
<p>If you&rsquo;re like us, and have the Raspberry Pi connected to your WiFi router via an ethernet cable <strong>and</strong> have also enabled WiFi when creating the OS image, then you will see two IP addresses.</p>
<p>In our case, we only want to use the wired connection, but now have the ability to easily turn on and off the Raspberry Pi&rsquo;s WiFi whenever we want.</p>
<p>To disable WiFi open the file <code>/boot/firmware/config.txt</code> and add this as the last line of that file:</p>
<pre><code class="language-bash">dtoverlay=disable-wifi
</code></pre>
<p>This line should be just under the <code>[all]</code> heading at the bottom of the file.  Then reboot the Raspberry Pi using</p>
<pre><code class="language-bash">$ sudo reboot
</code></pre>
<p>In your router&rsquo;s settings, give the Raspberry Pi machine a static IP address. </p>
<h2 class="template__section" id="ssh">SSH</h2>
<p>SSH is disabled by default on Raspberry Pi OS; it can be enabled using any of the four following methods below.  If you didn&rsquo;t already enable SSH when creating the OS image, you can use one of these.</p>
<div class="admonition note">
<p class="admonition-title">On desktop</p>
<pre><code>&gt;&gt; Raspberry Pi icon
&gt;&gt; Preferences menu
&gt;&gt; Raspberry Pi Configuration
&gt;&gt; Interfaces tab
&gt;&gt; Select "Enabled" next to SSH
&gt;&gt; Click OK
</code></pre>
</div>
<div class="admonition note">
<p class="admonition-title">While flashing an OS image</p>
<p>As we did above in the section <a href="#use-rp-imager">Use RP Imager</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">From the terminal</p>
<pre><code>$ sudo raspi-config

&gt;&gt; ```Interfacing Options```
&gt;&gt; Navigate to and select ```SSH```
&gt;&gt; Choose ```Yes```
&gt;&gt; Select ```Ok```
&gt;&gt; Choose ```Finish```
</code></pre>
</div>
<div class="admonition note">
<p class="admonition-title">Manually</p>
<p>Create an empty file named ssh in the boot partition:  </p>
<pre><code>$ sudo touch /boot/firmware/ssh
</code></pre>
<p>Reboot the machine:  </p>
<pre><code>$ sudo reboot
</code></pre>
</div>
<h2 class="template__section" id="ssh-without-password">SSH without Password</h2>
<p>On a machine that you wish to be able make an SSH connection to the Raspberry Pi without entering a password, run the following:</p>
<pre><code class="language-bash">$ ssh-copy-id [user@]&lt;hostname&gt;
</code></pre>
<p>where <code>[user@]</code> and <code>&lt;hostname&gt;</code> are that of the Raspberry Pi.</p>
<p>Enter the Raspberry Pi user&rsquo;s password (for the last time &hellip; yay!).</p>
<p>Now you can run</p>
<pre><code class="language-bash">$ ssh [user@]&lt;hostname&gt;
</code></pre>
<p>to access the Raspberry Pi&rsquo;s terminal without needing to give a password.</p>
                <p class="outro">To suggest an edit or correction to this page, please click the "Edit this page" button below or at the top to access the source file on GitHub.</p>
                <br>
                <div class="source-button-bottom">
                  <div class="source-button-bottom-inner">
                    <a id="a" class="source-button" href="raspberry_pi_initialize.md" title="View source of this page"><svg xmlns="http://www.w3.org/2000/svg" width="50px" height="50px" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg></a>
                    <label id="b">View</label>
                  </div>
                  <div class="source-button-bottom-inner">
                    <a id="c" class="source-button" href="" title="Edit this page"><svg xmlns="http://www.w3.org/2000/svg" width="50px" height="50px" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg></a>
                    <label id="d">Edit</label>
                  </div>
                </div>
              </article>
            </div>
        </div>
    </main>
    <footer class="footer">
      <!--<div><p>All content copyright Hylown</p></div>-->
      <div><a href="tou.html">Terms of Use</a></div>
      <div><a href="https://hylown.com"><img src="assets/portal.png" width="100px" height="100px"></a></div>
      <div><a href="">back to top</a></div>
    </footer>
  </div>
  <script>
    document.getElementById('RaspberryPi-Initialize').classList.add('active')
  </script>
  <script src="assets/javascript/hylowncom.js"></script>
</body>
</html>